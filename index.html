                    <!DOCTYPE html>
    <html lang="ar" dir="rtl">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <title>Ù…Ø·Ø¹Ù… Ø´ÙŠØ® Ø§Ù„Ø¨Ù„Ø¯ | ØªØ¬Ø±Ø¨Ø© Ø·Ø¹Ø§Ù… ÙØ±ÙŠØ¯Ø©</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <script type="module">
        // 1. Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…ÙƒØªØ¨Ø§Øª ÙØ§ÙŠØ¨Ø±Ø¨ÙŠØ² Ø¹Ø¨Ø± CDN (Ù„Ø§ ÙŠØ­ØªØ§Ø¬ ØªØ­Ù…ÙŠÙ„)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, set, push, onValue, update, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // 2. Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªÙƒ Ø§Ù„Ø®Ø§ØµØ© Ø§Ù„ØªÙŠ Ø£Ø±Ø³Ù„ØªÙ‡Ø§
        const firebaseConfig = {
          apiKey: "AIzaSyCYrGDMzUuQ1MiHmCy2OPId8yG07DyRT_g",
          authDomain: "sheikh-of-the-country.firebaseapp.com",
          projectId: "sheikh-of-the-country",
          storageBucket: "sheikh-of-the-country.firebasestorage.app",
          messagingSenderId: "767891906712",
          appId: "1:767891906712:web:1ee97ae642db1eb77b70ed",
          measurementId: "G-PLL1LDBRM1"
        };

        // 3. ØªØ´ØºÙŠÙ„ Ø§Ù„ÙØ§ÙŠØ±Ø¨ÙŠØ²
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        // 4. Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù…Ø­Ø±Ùƒ DB Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø¨Ù…Ø­Ø±Ùƒ ÙØ§ÙŠØ¨Ø±Ø¨ÙŠØ² Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
        // Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ Ø³ÙŠØ¬Ø¹Ù„ ÙƒÙ„ ÙˆØ¸Ø§Ø¦ÙÙƒ Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© (push, get, set) ØªØ¹Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø³Ø­Ø§Ø¨Ø© ÙÙˆØ±Ø§Ù‹
        window.DB = {
            get: (path) => {
                // Ø³ÙŠØªÙ… Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø¨Ø± Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙŠÙ† (onValue) Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø³Ø±Ø¹Ø©
                return JSON.parse(localStorage.getItem('sheikh_app_' + path) || '{}');
            },
            set: (path, val) => {
                set(ref(database, path), val);
            },
            push: (path, item) => {
                const newRef = push(ref(database, path));
                set(newRef, item);
                return { key: newRef.key };
            },
            update: (path, updates) => {
                update(ref(database, path), updates);
            },
            remove: (path) => {
                remove(ref(database, path));
            }
        };

        // 5. Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ (Real-time Sync)
        const collections = ['products', 'categories', 'orders', 'chats', 'team_chat', 'users'];
        collections.forEach(col => {
            onValue(ref(database, col), (snapshot) => {
                const data = snapshot.val() || {};
                localStorage.setItem('sheikh_app_' + col, JSON.stringify(data));
                // Ø¥Ø·Ù„Ø§Ù‚ Ø­Ø¯Ø« Ø§Ù„ØªØ­Ø¯ÙŠØ« Ù„ÙƒÙŠ ØªØ´Ø¹Ø± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø§Ù„ØªØºÙŠÙŠØ± ÙÙˆØ±Ø§Ù‹
                window.dispatchEvent(new Event('db_updated'));
                if (typeof refreshAll === 'function') refreshAll(); // Ù„Ù„Ù…Ø¯ÙŠØ±
                if (typeof renderOrders === 'function') renderOrders(); // Ù„Ù„Ù…Ø·Ø¨Ø®
                if (typeof refreshUI === 'function') refreshUI(); // Ù„Ù„Ø²Ø¨ÙˆÙ†
            });
        });

        // ØªØ£ÙƒØ¯ Ù…Ù† ØªØµØ¯ÙŠØ± Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ù„Ù„Ù€ window Ù„ÙŠØ±Ø§Ù‡Ø§ Ø§Ù„Ù€ HTML
        // exports will be added at end of main script
    </script>
    <style>
        :root {
            --primary: #730101;    /* Ø§Ù„Ø£Ø­Ù…Ø± Ø§Ù„Ø¯Ø§ÙƒÙ† */
            --secondary: #ffe755;   /* Ø§Ù„Ø£ØµÙØ± Ø§Ù„Ø°Ù‡Ø¨ÙŠ */
            --accent: #ffe755;     /* Ø§Ù„Ø£ØµÙØ± Ø§Ù„Ø°Ù‡Ø¨ÙŠ */
            --white: #ffffff;
            --bg-soft: #fffdf2;    /* Ø®Ù„ÙÙŠØ© Ù…Ø§Ø¦Ù„Ø© Ù„Ù„ØµÙØ±Ø© Ø§Ù„Ø®ÙÙŠÙØ© Ø¬Ø¯Ø§Ù‹ Ù„Ù„Ø±Ø§Ø­Ø© */
            --text-main: #2d0000;
            --text-muted: #8c7373;
            --glass: rgba(255, 255, 255, 0.9);
            --shadow: 0 10px 25px rgba(115, 1, 1, 0.1);
        }

            * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
            
            body { 
                font-family: 'Cairo', sans-serif; 
                margin: 0; 
                background: var(--bg-soft); 
                color: var(--text-main);
                overflow-x: hidden;
                line-height: 1.6;
            }

            /* Modern Loader */
            #loader-wrapper {
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: var(--white); z-index: 10000;
                display: flex; justify-content: center; align-items: center; flex-direction: column;
            }

            /* ØªØµÙ…ÙŠÙ… Ù„ÙˆØ¬Ùˆ Ø´ÙŠØ® Ø§Ù„Ø¨Ù„Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
            .main-logo-wrapper {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                padding: 10px;
            }

            .main-logo-icon {
                width: 85px;
                height: 85px;
                background: var(--primary); /* Ø£Ø­Ù…Ø± Ø¯Ø§ÙƒÙ† */
                border: 2px solid var(--accent); /* Ø¥Ø·Ø§Ø± Ø£ØµÙØ± */
                border-radius: 25px; /* Ø²ÙˆØ§ÙŠØ§ Ø¯Ø§Ø¦Ø±ÙŠØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ© */
                display: flex;
                justify-content: center;
                align-items: center;
                box-shadow: 0 10px 20px rgba(115, 1, 1, 0.2);
                position: relative;
            }

            /* Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø£ÙŠÙ‚ÙˆÙ†Ø© Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„ØµÙˆØ±Ø© */
            .main-logo-icon i {
                color: var(--accent); /* Ø£ÙŠÙ‚ÙˆÙ†Ø© ØµÙØ±Ø§Ø¡ */
                font-size: 40px;
            }

            .main-logo-text {
                margin-top: 12px;
                font-family: 'Cairo', sans-serif;
                font-weight: 900;
                font-size: 1.5rem;
                color: var(--primary); /* Ù†Øµ Ø£Ø­Ù…Ø± Ø¯Ø§ÙƒÙ† */
                text-align: center;
            }

            @keyframes pulse { 0% { transform: scale(0.95); opacity: 0.8; } 50% { transform: scale(1.05); opacity: 1; } 100% { transform: scale(0.95); opacity: 0.8; } }

            /* Floating Glass Header */
            header {
                background: var(--primary);
                color: var(--accent);
                padding: 10px 20px;
                display: flex;
                justify-content: space-between;
                align-items: center;
                position: sticky;
                top: 0;
                z-index: 5000;
                height: 75px;
                border-bottom: 1px solid var(--accent);
                box-shadow: var(--shadow);
            }

            .logo-text { font-weight: 900; font-size: 1.4rem; color: var(--primary); letter-spacing: -1px; }
            
            .nav-icons { display: flex; gap: 12px; }
            .icon-btn {
                width: 45px; height: 45px;
                background: rgba(255, 231, 85, 0.1);
                border-radius: 14px;
                display: flex; align-items: center; justify-content: center;
                font-size: 1.2rem; color: var(--accent);
                box-shadow: 0 4px 6px rgba(0,0,0,0.03);
                cursor: pointer; position: relative;
                transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }
            .icon-btn:active { transform: scale(0.9); }
            .icon-btn .badge {
                position: absolute; top: -5px; right: -5px;
                background: var(--accent); color: var(--primary);
                font-size: 0.7rem; padding: 2px 6px; border-radius: 8px;
                border: 2px solid white;
            }

            /* Modern Hero Section */
            .hero {
                margin: 20px;
                height: 180px;
                border-radius: 30px;
                background: linear-gradient(135deg, var(--primary) 0%, #4a0000 100%);
                display: flex; align-items: center; justify-content: center;
                color: var(--accent); text-align: center;
                position: relative; overflow: hidden;
                box-shadow: 0 15px 30px rgba(115, 1, 1, 0.2);
            }
            .hero::after {
                content: ''; position: absolute; width: 200px; height: 200px;
                background: rgba(255,231,85,0.1); border-radius: 50%;
                top: -50px; left: -50px;
            }
            .hero-content h1 { font-size: 1.8rem; margin: 0; font-weight: 900; }
            .hero-content p { font-size: 0.9rem; opacity: 0.9; margin: 5px 0 0; }

            /* Smooth Categories */
            .categories-container {
                display: flex; overflow-x: auto;
                padding: 10px 20px 25px;
                gap: 12px; scrollbar-width: none;
            }
            .categories-container::-webkit-scrollbar { display: none; }
            
            .cat-pill {
                padding: 10px 24px;
                background: var(--white);
                border-radius: 18px;
                white-space: nowrap;
                font-weight: 700;
                font-size: 0.95rem;
                color: var(--text-muted);
                box-shadow: var(--shadow);
                cursor: pointer;
                transition: 0.3s;
                border: 1px solid transparent;
            }
            .cat-pill.active {
                background: var(--accent);
                color: var(--primary);
                transform: translateY(-3px);
                box-shadow: 0 10px 20px rgba(255, 231, 85, 0.3);
            }

            /* Elegant Product Cards */
            .products-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
                padding: 0 20px;
            }
            .product-card {
                background: var(--white);
                border-radius: 25px;
                overflow: hidden;
                box-shadow: var(--shadow);
                transition: 0.3s;
                display: flex;
                flex-direction: column;
                border: 1px solid rgba(0,0,0,0.02);
            }
            .product-card img {
                width: 100%; height: 140px;
                object-fit: cover;
                transition: 0.5s;
            }
            .product-card:hover img { transform: scale(1.05); }

            .product-info { padding: 15px; flex-grow: 1; display: flex; flex-direction: column; }
            .product-info h3 { font-size: 1rem; margin: 0; font-weight: 800; color: var(--text-main); }
            .product-info .price-tag {
                background: #fff8e1; color: #ffa000;
                padding: 4px 10px; border-radius: 10px;
                font-size: 0.85rem; font-weight: 800;
                align-self: flex-start; margin: 8px 0;
            }
            
            .add-btn {
                background: var(--primary);
                color: white; border: none;
                padding: 10px; border-radius: 14px;
                font-weight: 700; cursor: pointer;
                width: 100%; display: flex; align-items: center; justify-content: center; gap: 8px;
                transition: 0.3s;
            }
            .add-btn:hover { background: #5a0000; }

            /* Modern Modals */
            .modal {
                display: none; position: fixed; top: 0; left: 0;
                width: 100%; height: 100%;
                background: rgba(15, 23, 42, 0.7);
                backdrop-filter: blur(8px);
                -webkit-backdrop-filter: blur(8px);
                z-index: 9999; justify-content: center; align-items: flex-end;
            }
            .modal-content {
                background: var(--white);
                width: 100%;
                max-width: 500px;
                border-radius: 35px 35px 0 0;
                padding: 30px 25px;
                position: relative;
                animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            }
            @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

            .close-handle {
                width: 50px; height: 5px; background: #e2e8f0;
                border-radius: 10px; margin: -15px auto 20px;
            }

            /* ØªØµÙ…ÙŠÙ… Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø·ÙˆØ± */
            .modal-content.product-details {
                padding: 0;
                overflow: hidden;
                border-radius: 30px;
                background: #fff;
                max-width: 450px;
            }

            .modal-img-header {
                width: 100%;
                height: 200px;
                object-fit: cover;
            }

            .product-details-body {
                padding: 20px 25px;
            }

            .variant-card {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 15px 20px;
                margin-bottom: 12px;
                border: 2px solid #f1f5f9;
                border-radius: 18px;
                cursor: pointer;
                transition: 0.3s;
            }

            .variant-card.active {
                border-color: var(--primary);
                background: #f0f4ff;
            }

            .variant-card b {
                color: var(--text-main);
                font-size: 1.1rem;
            }

            .variant-card .price {
                color: var(--secondary);
                font-weight: 800;
            }

            /* Ù…ØªØ­ÙƒÙ… Ø§Ù„ÙƒÙ…ÙŠØ© */
            .qty-wrapper {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 20px;
                margin: 25px 0;
                background: #f8fafc;
                padding: 10px;
                border-radius: 20px;
            }

            .qty-btn {
                width: 45px;
                height: 45px;
                border-radius: 15px;
                border: none;
                background: white;
                color: var(--primary);
                font-size: 1.2rem;
                cursor: pointer;
                box-shadow: 0 4px 10px rgba(0,0,0,0.05);
                transition: 0.2s;
            }

            .qty-btn:active { transform: scale(0.9); }

            #qtyCount {
                font-size: 1.5rem;
                font-weight: 900;
                color: var(--primary);
                min-width: 30px;
                text-align: center;
            }

            .modal-footer-ui {
                display: flex;
                gap: 15px;
                align-items: center;
                padding-top: 15px;
                border-top: 1px solid #f1f5f9;
            }

            .total-price-box {
                flex: 1;
            }

            .total-price-box span { font-size: 0.8rem; color: #64748b; display: block; }
            .total-price-box b { font-size: 1.4rem; color: var(--secondary); display: block; }

            .custom-input {
                width: 100%; padding: 15px;
                margin-bottom: 15px;
                border: 2px solid #f1f5f9;
                border-radius: 18px;
                background: #f8fafc;
                font-family: 'Cairo'; font-size: 1rem;
                transition: 0.3s;
            }
            .custom-input:focus { border-color: var(--primary); background: white; }

            .btn-action {
                background: var(--primary); color: white;
                width: 100%; padding: 16px; border: none;
                border-radius: 18px; font-weight: 800; font-size: 1.1rem;
                box-shadow: 0 10px 20px rgba(26, 35, 126, 0.2);
                cursor: pointer;
            }

            /* 1. ØªØµÙ…ÙŠÙ… Ø²Ø± Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø¹Ø§Ø¦Ù… Ø§Ù„Ù…Ø·ÙˆØ± */
            .chat-btn {
                position: fixed;
                bottom: 95px; /* Ø±ÙØ¹Ù†Ø§Ù‡ Ù„ÙŠÙƒÙˆÙ† ÙÙˆÙ‚ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ Ø¨Ù…Ø³Ø§ÙØ© ÙƒØ§ÙÙŠØ© */
                left: 20px;
                width: 60px;
                height: 60px;
                background: linear-gradient(135deg, #d32f2f 0%, #8c0104 100%);
                color: white;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.6rem;
                box-shadow: 0 10px 25px rgba(211, 47, 47, 0.4);
                z-index: 4000;
                cursor: pointer;
                border: 3px solid #fff;
                transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            }

            /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ø¨Ø¶ Ù„Ø¬Ø°Ø¨ Ø§Ù„Ø§Ù†ØªØ¨Ø§Ù‡ */
            .chat-btn::after {
                content: '';
                position: absolute;
                width: 100%;
                height: 100%;
                background: inherit;
                border-radius: 50%;
                z-index: -1;
                animation: chatPulse 2s infinite;
                opacity: 0.5;
            }

            @keyframes chatPulse {
                0% { transform: scale(1); opacity: 0.5; }
                100% { transform: scale(1.6); opacity: 0; }
            }

            .chat-btn:hover {
                transform: scale(1.1) rotate(15deg);
                box-shadow: 0 15px 30px rgba(211, 47, 47, 0.5);
            }

            .chat-window {
                display: none; position: fixed; bottom: 100px; left: 25px;
                width: 320px; height: 450px;
                background: var(--white); border-radius: 25px;
                box-shadow: 0 20px 40px rgba(0,0,0,0.15);
                z-index: 4000; flex-direction: column; overflow: hidden;
                border: 1px solid #f1f5f9; animation: slideUp 0.3s;
            }

            /* Cart & Orders Layout */
            .cart-item {
                display: flex; justify-content: space-between; align-items: center;
                padding: 15px; background: #f8fafc; border-radius: 15px; margin-bottom: 10px;
            }

            /* ØªØ­Ø³ÙŠÙ† Ø´ÙƒÙ„ Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø³Ù„Ø© */
            #cartModal .modal-content {
                background: #f8fafc;
                border-radius: 30px 30px 0 0;
                padding: 25px;
            }

            /* Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø³Ù„Ø© */
            .cart-header-ui {
                text-align: center;
                margin-bottom: 20px;
            }
            .cart-header-ui h2 {
                font-size: 1.4rem;
                color: #1e293b;
                font-weight: 800;
                margin: 0;
            }

            /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø³Ù„Ø© */
            .cart-item-card {
                background: #ffffff;
                border-radius: 20px;
                padding: 15px;
                margin-bottom: 12px;
                display: flex;
                justify-content: space-between;
                align-items: center;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
                border: 1px solid #f1f5f9;
            }

            .cart-item-info h4 {
                margin: 0;
                font-size: 1.05rem;
                color: #1e293b;
                font-weight: 700;
            }
            .cart-item-info span {
                font-size: 0.85rem;
                color: #94a3b8;
                display: block;
                margin-top: 4px;
            }

            .cart-item-price {
                text-align: left;
            }
            .cart-item-price b {
                color: #e11d48; /* Ù„ÙˆÙ† Ø£Ø­Ù…Ø± Ø¹ØµØ±ÙŠ Ù„Ù„Ø³Ø¹Ø± */
                font-size: 1.1rem;
                display: block;
            }

            /* Ø²Ø± Ø§Ù„Ø­Ø°Ù Ø¨Ø´ÙƒÙ„ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø¨Ø³ÙŠØ·Ø© */
            .remove-item-btn {
                color: #cbd5e1;
                cursor: pointer;
                transition: 0.2s;
                font-size: 1.2rem;
                margin-right: 15px;
            }
            .remove-item-btn:hover { color: #f43f5e; }

            /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ */
            .cart-summary {
                background: #ffffff;
                border-radius: 20px;
                padding: 20px;
                margin-top: 20px;
                box-shadow: 0 -5px 20px rgba(0,0,0,0.02);
            }

            .summary-row {
                display: flex;
                justify-content: space-between;
                margin-bottom: 10px;
            }
            .summary-row.total {
                margin-top: 10px;
                padding-top: 10px;
                border-top: 1px dashed #e2e8f0;
            }
            .summary-row.total b {
                font-size: 1.4rem;
                color: #18248b;
            }

            /* Ø²Ø± ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ù…Ø·ÙˆØ± */
            .btn-confirm-order {
                background: linear-gradient(135deg, #18248b 0%, #0c144d 100%);
                color: white;
                width: 100%;
                padding: 18px;
                border: none;
                border-radius: 20px;
                font-size: 1.1rem;
                font-weight: 800;
                cursor: pointer;
                margin-top: 15px;
                box-shadow: 0 10px 15px -3px rgba(24, 36, 139, 0.3);
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 10px;
                transition: 0.3s;
            }
            .btn-confirm-order:active { transform: scale(0.98); }

        /* Ø§Ù„ØªØ°ÙŠÙŠÙ„ Ø§Ù„Ù…Ø·ÙˆØ± (Footer) */
        .footer-minimal {
            padding: 60px 20px 120px; /* Ù…Ø³Ø§Ø­Ø© ÙƒØ§ÙÙŠØ© */
            background: #ffffff;
            border-top: 1px solid #f1f5f9;
            position: relative;
            overflow: hidden;
        }

        /* Ø¥Ø¶Ø§ÙØ© Ø®Ù„ÙÙŠØ© ÙÙ†ÙŠØ© Ø®ÙÙŠÙØ© Ù„Ù„ØªØ°ÙŠÙŠÙ„ */
        .footer-minimal::before {
            content: 'SHEIKH ELBALAD';
            position: absolute;
            bottom: -10px;
            right: -10px;
            font-size: 5rem;
            font-weight: 900;
            color: #f8fafc;
            z-index: 0;
            pointer-events: none;
            letter-spacing: 5px;
        }

        .social-bar {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
        }

        .social-link {
            width: 50px;
            height: 50px;
            background: #f8fafc;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            color: #1e293b;
            text-decoration: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
        }

        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø¹Ù†Ø¯ Ø§Ù„Ù…Ø±ÙˆØ± Ø¨Ø§Ù„Ù…Ø§ÙˆØ³ */
        .social-link.facebook:hover { background: #1877f2; color: white; transform: translateY(-5px); }
        .social-link.whatsapp:hover { background: #25d366; color: white; transform: translateY(-5px); }
        .social-link.phone:hover { background: #18248b; color: white; transform: translateY(-5px); }

        .copyright-text {
            color: #94a3b8;
            font-size: 0.9rem;
            font-weight: 600;
        }



        /* 2. ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø³ÙÙ„ÙŠ (Ø§Ù„Ø£Ø¨ÙŠØ¶ Ù…Ø¹ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„Ù…Ø±Ø¨Ø¹Ø©) */
        .footer-bottom-light {
            background: #ffffff;
            padding: 40px 20px 110px; /* Ù…Ø³Ø§Ø­Ø© Ù„Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ */
            text-align: right; /* Ù…Ø­Ø§Ø°Ø§Ø© Ù„Ù„ÙŠÙ…ÙŠÙ† ÙƒÙ…Ø§ ÙÙŠ ØµÙˆØ±ØªÙƒ */
        }

        .footer-bottom-light .icon-group {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
        }

        .footer-bottom-light .square-icon {
            width: 45px;
            height: 45px;
            background: #f8fafc;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: #1e293b;
            box-shadow: 0 4px 6px rgba(0,0,0,0.02);
        }

        .footer-bottom-light .copy-info {
            color: #94a3b8;
            font-size: 0.85rem;
            line-height: 1.8;
        }

        /* 3. Ø²Ø± Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ (Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ ÙÙŠ Ø§Ù„Ø¬Ù†Ø¨) */
        .support-btn-red {
            position: fixed;
            bottom: 95px;
            left: 20px;
            width: 55px;
            height: 55px;
            background: #b71c1c; /* Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø­Ù…Ø± Ù…Ù† ØµÙˆØ±ØªÙƒ */
            border: 3px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.4rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            cursor: pointer;
            z-index: 4000;
        }

        /* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ Ø§Ù„Ø°ÙƒÙŠ (Bottom Navigation Bar) */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            height: 75px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 4500;
            box-shadow: 0 -10px 25px rgba(0,0,0,0.05);
            border-top: 1px solid rgba(226, 232, 240, 0.5);
            padding-bottom: env(safe-area-inset-bottom); /* Ù„Ø¯Ø¹Ù… Ù‡ÙˆØ§ØªÙ Ø§Ù„Ø¢ÙŠÙÙˆÙ† Ø§Ù„Ø­Ø¯ÙŠØ«Ø© */
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            color: #94a3b8;
            text-decoration: none;
            font-size: 0.75rem;
            font-weight: 800;
            cursor: pointer;
            transition: 0.3s;
            position: relative;
            flex: 1;
        }

        .nav-item.active { color: var(--primary); }
        .nav-item i { font-size: 1.5rem; transition: 0.3s; }
        .nav-item:active i { transform: scale(0.8); }

        /* Ø´Ø§Ø±Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù†Ø§ØµØ± ÙÙŠ Ø§Ù„Ø³Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ */
        .cart-badge-nav {
            position: absolute;
            top: -5px;
            right: 25%;
            background: #e11d48;
            color: white;
            font-size: 0.7rem;
            padding: 2px 7px;
            border-radius: 10px;
            border: 2px solid white;
            font-weight: 900;
        }

        /* Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© */
        :root {
            --brand-red: #721812;
            --brand-yellow: #ffe755;
        }

        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø´Ø±ÙŠØ·Ø© Ø§Ù„Ø³ÙÙ„ÙŠØ© (Footer Strip) */
        .footer-strip {
            background: var(--brand-red);
            border-top: 4px solid var(--brand-yellow);
            padding: 20px;
            color: var(--brand-yellow);
            text-align: center;
            margin-bottom: 75px; /* Ù…Ø³Ø§Ø­Ø© Ù„Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ */
        }

        .footer-strip .social-box {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .footer-strip .icon-item {
            width: 45px;
            height: 45px;
            background: rgba(255, 231, 85, 0.1); /* Ø´ÙØ§ÙÙŠØ© Ù…Ù† Ø§Ù„Ø£ØµÙØ± */
            border: 1px solid var(--brand-yellow);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--brand-yellow);
            font-size: 1.2rem;
            transition: 0.3s;
        }

        .footer-strip .icon-item:hover {
            background: var(--brand-yellow);
            color: var(--brand-red);
        }

        /* Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ */
        .profile-card {
            text-align: center;
            padding: 20px;
        }
        .profile-info-row {
            background: #f8fafc;
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-right: 4px solid var(--brand-red);
        }
        .profile-info-row i { color: var(--brand-red); font-size: 1.2rem; }

        /* ØªØ­Ø¯ÙŠØ« Ø£Ù„ÙˆØ§Ù† Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª */

        /* 1. Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø³Ù„Ø© ÙˆØ§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© */
        .cart-header-ui h2 {
            color: #721812 !important; /* Ø§Ù„Ø£Ø­Ù…Ø± Ø§Ù„Ø¯Ø§ÙƒÙ† */
        }
        .cart-header-ui i {
            color: #721812 !important;
        }

        /* 2. Ù†ØµÙˆØµ Ø§Ù„Ù…Ù„Ø®Øµ (Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØµÙ†Ø§Ù) */
        .summary-row span {
            color: #721812;
            font-weight: 700;
        }

        /* 3. Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨ (Ø§Ù„Ø³Ø¹Ø±) */
        .summary-row.total b {
            color: #721812 !important;
            font-size: 1.6rem;
        }

        /* 4. Ø²Ø± ØªØ£ÙƒÙŠØ¯ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ */
        .btn-confirm-order {
            background: #721812 !important; /* Ø®Ù„ÙÙŠØ© Ø­Ù…Ø±Ø§Ø¡ Ø¯Ø§ÙƒÙ†Ø© */
            color: #ffe755 !important;      /* Ù†Øµ ÙˆØ£ÙŠÙ‚ÙˆÙ†Ø© Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£ØµÙØ± Ø§Ù„Ø°Ù‡Ø¨ÙŠ */
            border: 1px solid #ffe755;      /* Ø¥Ø·Ø§Ø± Ø®ÙÙŠÙ Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£ØµÙØ± Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ÙØ®Ø§Ù…Ø© */
            box-shadow: 0 10px 15px -3px rgba(114, 24, 18, 0.3) !important;
        }

        .btn-confirm-order i {
            color: #ffe755 !important;
        }

        /* ØªØ£Ø«ÙŠØ± Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± */
        .btn-confirm-order:active {
            background: #5a120e !important; /* Ø¯Ø±Ø¬Ø© Ø£ØºÙ…Ù‚ Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± */
            transform: scale(0.98);
        }

        /* 5. Ø´ÙƒÙ„ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¯Ø§Ø®Ù„ Ø§Ù„Ø³Ù„Ø© (Ù„Ù„ØªÙ†Ø§Ø³Ù‚) */
        .cart-item-card {
            border-right: 4px solid #721812; /* Ø®Ø· Ø¬Ø§Ù†Ø¨ÙŠ Ø£Ø­Ù…Ø± */
            background: #ffffff;
        }

        .cart-item-price b {
            color: #721812;
        }

        .remove-item-btn {
            color: #721812;
            opacity: 0.5;
        }
        .remove-item-btn:hover {
            opacity: 1;
            color: #721812;
        }

        /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø¨Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø¨Ø±Ø§Ù†Ø¯ */
        #orderModal .modal-content {
            border-radius: 20px;
            border: none;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }

        #orderModal .modal-header {
            background: #730101; /* Ø§Ù„Ø£Ø­Ù…Ø± Ø§Ù„Ø¯Ø§ÙƒÙ† */
            color: #ffe755;    /* Ø§Ù„Ø£ØµÙØ± Ø§Ù„Ø°Ù‡Ø¨ÙŠ */
            padding: 20px;
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .order-detail-card {
            background: #fffdf2;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 15px;
            border-right: 5px solid #730101;
        }

        .reason-box {
            background: #fff1f0;
            border: 1px solid #730101;
            color: #730101;
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 15px;
            font-weight: bold;
        }

        /* ØªØ­Ø³ÙŠÙ† Ø´ÙƒÙ„ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø³Ø¬Ù„ */
        .status-badge.status-cancelled {
            background: #730101;
            color: #ffe755;
            padding: 4px 12px;
            border-radius: 8px;
            display: inline-block;
        }

        .cancellation-text {
            display: block;
            font-size: 0.8rem;
            margin-top: 5px;
            color: #730101;
            font-weight: 600;
        }

        /* Hide Scrollbar */
            * { -ms-overflow-style: none; scrollbar-width: none; }
            *::-webkit-scrollbar { display: none; }
        </style>
    </head>
    <body>

        <!-- Modern Loader -->
        <div id="loader-wrapper">
            <div class="main-logo-wrapper">
                <div class="main-logo-icon">
                    <img src="792c5d7f-7b45-4e3f-9333-c69926ecaa3f (1).jpg" alt="Ø´ÙŠØ® Ø§Ù„Ø¨Ù„Ø¯" style="width:100%; height:100%; object-fit:cover; border-radius:25px;">
                </div>
                <div class="main-logo-text">Ø´ÙŠØ® Ø§Ù„Ø¨Ù„Ø¯</div>
            </div>
        </div>

        <audio id="msgSound" src="https://assets.mixkit.co/active_storage/sfx/2346/2346-preview.mp3"></audio>

        <header>
            <div class="nav-icons">
                <div class="icon-btn" onclick="openCart()">
                    <i class="fas fa-shopping-bag"></i>
                    <span class="badge" id="cartCount">0</span>
                </div>
                <div class="icon-btn" onclick="openMyOrders()"><i class="fas fa-history"></i></div>
                <div id="loginBtnNav" class="icon-btn" onclick="openAuth()"><i class="fas fa-user-plus"></i></div>
                <div id="userProfileNav" class="icon-btn" style="display:none;" onclick="openProfile()"><i class="fas fa-user-check"></i></div>
            </div>

            <!-- Ø§Ù„Ù„ÙˆØ¬Ùˆ Ø§Ù„ØµØºÙŠØ± ÙÙŠ Ø§Ù„Ù‡ÙŠØ¯Ø± -->
            <div style="display: flex; align-items: center; gap: 10px;">
                <span style="font-weight: 800; color: var(--primary); font-size: 1.2rem;">Ø´ÙŠØ® Ø§Ù„Ø¨Ù„Ø¯</span>
                <div class="main-logo-icon" style="width: 45px; height: 45px; border-radius: 12px; box-shadow: none;">
                    <img src="792c5d7f-7b45-4e3f-9333-c69926ecaa3f (1).jpg" alt="Ø´ÙŠØ® Ø§Ù„Ø¨Ù„Ø¯" style="width:100%; height:100%; object-fit:cover; border-radius:12px;">
                </div>
            </div>
        </header>

        <div class="hero">
            <div class="hero-content">
                <h1>Ø£ØµÙ„ Ø§Ù„Ø£ÙƒÙ„ Ø§Ù„Ù…ØµØ±ÙŠ ğŸ‡ªğŸ‡¬</h1>
                <p>Ù…Ù†Ø° Ø¹Ø§Ù… 1958 ÙˆØ§Ù„Ø·Ø¹Ù… ÙŠØ­ÙƒÙŠ Ø§Ù„Ø­ÙƒØ§ÙŠØ©</p>
            </div>
        </div>
        
        <div class="categories-container" id="categoryNav"></div>

        <div class="products-grid" id="productGrid"></div>
        
    <!-- Ø§Ù„ØªØ°ÙŠÙŠÙ„ Ø¨Ø´ÙƒÙ„ Ø´Ø±ÙŠØ·Ø© (Footer Strip) -->
    <footer class="footer-strip">
        <div class="social-box">
            <a href="tel:15188" class="icon-item"><i class="fas fa-phone-alt"></i></a>
            <a href="https://wa.me/201015955557" class="icon-item"><i class="fab fa-whatsapp"></i></a>
            <a href="https://www.facebook.com/hatysheikhelbalad/" class="icon-item"><i class="fab fa-facebook-f"></i></a>
        </div>

        <div style="font-weight: 700; font-size: 0.9rem;">
            Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ø´ÙŠØ® Ø§Ù„Ø¨Ù„Ø¯ Â© 2024
            <br>
            <small style="opacity: 0.7;">Ø¨ÙƒÙ„ Ø­Ø¨ Ù…Ù† Ø£Ø¬Ù„ÙƒÙ…</small>
        </div>
    </footer>

    <!-- Ø²Ø± Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ø£Ø­Ù…Ø± (Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰) -->
    <div class="support-btn-red" onclick="toggleChat()">
        <i class="fas fa-headset"></i>
    </div>

    <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ (Bottom Nav) -->
    <nav class="bottom-nav">
        <div class="nav-item active" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
            <i class="fas fa-home"></i>
            <span>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        </div>

        <div class="nav-item" onclick="openMyOrders()">
            <i class="fas fa-file-invoice"></i>
            <span>Ø·Ù„Ø¨Ø§ØªÙŠ</span>
        </div>

        <div class="nav-item" onclick="openCart()">
            <i class="fas fa-shopping-bag"></i>
            <span>Ø§Ù„Ø³Ù„Ø©</span>
            <span class="cart-badge-nav" id="bottomCartCount">0</span>
        </div>

        <div id="bottomProfileItem" class="nav-item" onclick="currentUser ? openProfile() : openAuth()">
            <i class="fas fa-user-circle"></i>
            <span id="profileText">Ø­Ø³Ø§Ø¨ÙŠ</span>
        </div>
    </nav>
        
        <!-- Modals -->
        <div class="modal" id="authModal">
            <div class="modal-content">
                <div class="close-handle" onclick="closeModal('authModal')"></div>
                <h2 style="text-align:center; margin-bottom: 25px;">Ø§Ù†Ø¶Ù… Ù„Ø¹Ø§Ø¦Ù„Ø© Ø´ÙŠØ® Ø§Ù„Ø¨Ù„Ø¯</h2>
                <input type="text" id="regName" class="custom-input" placeholder="Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„ÙƒØ§Ù…Ù„">
                <input type="tel" id="regPhone" class="custom-input" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
                <select id="regZone" class="custom-input">
                    <option value="" disabled selected>Ø§Ø®ØªØ± Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªÙˆØµÙŠÙ„</option>
                    <option value="Ø§Ù„Ù…Ø¹Ø§Ø¯ÙŠ">Ø§Ù„Ù…Ø¹Ø§Ø¯ÙŠ</option>
                    <option value="Ù…Ø¯ÙŠÙ†Ø© Ù†ØµØ±">Ù…Ø¯ÙŠÙ†Ø© Ù†ØµØ±</option>
                    <option value="Ø§Ù„Ù‡Ø±Ù…">Ø§Ù„Ù‡Ø±Ù…</option>
                    <option value="Ø§Ù„ØªØ¬Ù…Ø¹">Ø§Ù„ØªØ¬Ù…Ø¹</option>
                </select>
                <button id="gpsBtn" class="btn-action" style="background: #10b981; margin-bottom: 15px;" onclick="getUserLocation()">
                    <i class="fas fa-location-arrow"></i> ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
                </button>
                <input type="text" id="regAddress" class="custom-input" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„ (Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…Ø§Ø±Ø©/Ø§Ù„Ø´Ù‚Ø©)">
                <button class="btn-action" onclick="handleRegister()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</button>
            </div>
        </div>
        
        <div class="modal" id="optionsModal">
            <div class="modal-content product-details">
                <div class="close-handle" onclick="closeModal('optionsModal')" style="position: absolute; top: 15px; left: 15px; background: rgba(255,255,255,0.8); z-index: 10;"></div>
                <img id="optProdImg" class="modal-img-header" src="" alt="">

                <div class="product-details-body">
                    <h2 id="optProdName" style="margin: 0 0 15px 0; color: var(--primary); font-weight: 900;"></h2>

                    <p style="color: #64748b; margin-bottom: 10px; font-weight: 600;">Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹:</p>
                    <div id="variantsList"></div>

                    <textarea id="itemNote" class="custom-input" placeholder="Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø£ÙŠ Ø·Ù„Ø¨ Ø®Ø§ØµØŸ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" style="height: 80px; resize: none;"></textarea>

                    <div class="qty-wrapper">
                        <button class="qty-btn" onclick="updateQty(1)"><i class="fas fa-plus"></i></button>
                        <span id="qtyCount">1</span>
                        <button class="qty-btn" onclick="updateQty(-1)"><i class="fas fa-minus"></i></button>
                    </div>

                    <div class="modal-footer-ui">
                        <div class="total-price-box">
                            <span>Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span>
                            <b id="finalModalPrice">0 Ø¬.Ù…</b>
                        </div>
                        <button class="btn-action" style="flex: 2;" onclick="confirmAddToCart()">Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="modal" id="cartModal">
            <div class="modal-content">
                <div class="close-handle" onclick="closeModal('cartModal')"></div>

                <div class="cart-header-ui">
                    <h2><i class="fas fa-shopping-basket"></i> Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h2>
                </div>

                <div id="cartItems" style="max-height: 350px; overflow-y: auto; padding: 5px;">
                    <!-- Ø³ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ù‡Ù†Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© JS -->
                </div>

                <div class="cart-summary">
                    <div class="summary-row">
                        <span>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØµÙ†Ø§Ù</span>
                        <span id="itemsCount">0</span>
                    </div>
                    <div class="summary-row total">
                        <span style="font-weight: 800; color: #64748b;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨</span>
                        <b id="cartTotal">0 Ø¬.Ù…</b>
                    </div>

                    <button class="btn-confirm-order" onclick="submitOrder()">
                        ØªØ£ÙƒÙŠØ¯ ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>

        <div class="modal" id="successModal">
            <div class="modal-content" style="text-align:center; padding: 50px 25px;">
                <div style="width: 80px; height: 80px; background: #ecfdf5; color: #10b981; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; margin: 0 auto 20px;">
                    <i class="fas fa-check"></i>
                </div>
                <h2>ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ!</h2>
                <p style="color: var(--text-muted);">Ø·Ù„Ø¨Ùƒ Ø§Ù„Ø¢Ù† Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©ØŒ Ø³ÙŠØµÙ„Ùƒ ÙÙŠ Ø£Ø³Ø±Ø¹ ÙˆÙ‚Øª.</p>
                <button class="btn-action" onclick="closeSuccessModal()">Ù…ØªØ§Ø¨Ø¹Ø© Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨</button>
            </div>
        </div>

        <div class="modal" id="ordersModal">
            <div class="modal-content" style="max-height: 80vh;">
                <div class="close-handle" onclick="closeModal('ordersModal')"></div>
                <h2 style="text-align:center; margin-bottom: 20px;">ØªØ§Ø±ÙŠØ® Ø·Ù„Ø¨Ø§ØªÙƒ</h2>
                <div id="ordersList" style="overflow-y: auto;"></div>
            </div>
        </div>

        <!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ (Profile Modal) -->
        <div class="modal" id="profileModal">
            <div class="modal-content">
                <div class="close-handle" onclick="closeModal('profileModal')"></div>
                <h2 style="text-align:center; color: var(--brand-red);">Ù…Ù„ÙÙŠ Ø§Ù„Ø´Ø®ØµÙŠ</h2>
                <div id="profileDetails" class="profile-card">
                    <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ Ø¨ÙˆØ§Ø³Ø·Ø© JS -->
                </div>
                <button class="btn-action" style="background:#ccc; color:black; box-shadow:none;" onclick="logoutUser()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>

        <!-- Chat Overlay -->
        <div class="chat-btn" id="chatFloat" onclick="toggleChat()"><i class="fas fa-comment-dots"></i></div>
        <div class="chat-window" id="chatWindow">
            <div style="background:var(--primary); color:white; padding:18px; display:flex; justify-content:space-between; align-items: center;">
                <span style="font-weight: 800;"><i class="fas fa-headset"></i> Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</span>
                <i class="fas fa-times" onclick="toggleChat()" style="cursor: pointer;"></i>
            </div>
            <div id="chatBody" style="flex:1; padding:15px; overflow-y:auto; background:#f8fafc; display:flex; flex-direction:column; gap:8px;"></div>
            <div style="padding:15px; border-top:1px solid #f1f5f9; display:flex; gap: 8px;">
                <input type="text" id="chatInput" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³ØªÙØ³Ø§Ø±Ùƒ Ù‡Ù†Ø§..." style="flex:1; border:none; background:#f1f5f9; padding:12px; border-radius:12px; outline:none;">
                <button onclick="sendChat()" style="background:var(--primary); color:white; border:none; width:45px; height:45px; border-radius:12px;"><i class="fas fa-paper-plane"></i></button>
            </div>
        </div>

        <script>
            // Firebase DB is loaded in module script

        let cart = [];
        let currentUser = JSON.parse(localStorage.getItem('sheikh_user_info'));
        let products = [];
        let selectedProductTemp = null;
        let selectedVariantTemp = null;
        let currentQty = 1;
        let tempCoords = null;

        function initData() {
            // ØªÙ‡ÙŠØ¦Ø© Ù…Ù†ØªØ¬Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©
            if(Object.keys(DB.get('products')).length === 0) {
                const def = [
                    {name: "Ø´Ø§ÙˆØ±Ù…Ø§ Ù„Ø­Ù… Ø³ÙˆØ¨Ø±", cat: "Ø³Ù†Ø¯ÙˆØªØ´Ø§Øª", img: "https://images.unsplash.com/photo-1633321702518-7feccaf0ad44?auto=format&fit=crop&w=400", available: true, variants: [{bread: "ØµØ§Ø¬ Ø¹Ø§Ø¦Ù„ÙŠ", price: 95}, {bread: "ÙØ±Ù†Ø³Ø§ÙˆÙŠ", price: 80}]},
                    {name: "ÙˆØ¬Ø¨Ø© Ø´ÙŠØ® Ø§Ù„Ø¨Ù„Ø¯", cat: "ÙˆØ¬Ø¨Ø§Øª", img: "https://images.unsplash.com/photo-1555939594-58d7cb561ad1?auto=format&fit=crop&w=400", available: true, variants: [{bread: "Ø±Ø¨Ø¹ ÙØ±Ø®Ø©", price: 140}, {bread: "Ù†Øµ ÙØ±Ø®Ø©", price: 210}]},
                    {name: "Ø­ÙˆØ§ÙˆØ´ÙŠ Ø¥Ø³ÙƒÙ†Ø¯Ø±Ø§Ù†ÙŠ", cat: "Ø³Ù†Ø¯ÙˆØªØ´Ø§Øª", img: "https://images.unsplash.com/photo-1626074353765-517a681e40be?auto=format&fit=crop&w=400", available: true, variants: [{bread: "Ø±ØºÙŠÙ ÙƒØ§Ù…Ù„", price: 70}]},
                    {name: "ÙƒÙˆØ¨ÙŠØ¨Ø© ÙˆØ³Ù…Ø¨ÙˆØ³Ùƒ", cat: "Ù…Ù‚Ø¨Ù„Ø§Øª", img: "https://images.unsplash.com/photo-1606331145362-ec76a636906a?auto=format&fit=crop&w=400", available: true, variants: [{bread: "Ø·Ø¨Ù‚ Ù…Ø´ÙƒÙ„", price: 65}]}
                ];
                def.forEach(i => DB.push('products', i));
                DB.push('categories', {name: "Ø³Ù†Ø¯ÙˆØªØ´Ø§Øª"});
                DB.push('categories', {name: "ÙˆØ¬Ø¨Ø§Øª"});
                DB.push('categories', {name: "Ù…Ù‚Ø¨Ù„Ø§Øª"});
            }
        }

        function refreshUI() {
            products = Object.values(DB.get('products'));
            const cats = Object.values(DB.get('categories'));
            const nav = document.getElementById('categoryNav');
            
            nav.innerHTML = '<div class="cat-pill active" onclick="filterCat(\'all\',this)">Ø§Ù„ÙƒÙ„</div>';
            cats.forEach(c => {
                nav.innerHTML += `<div class="cat-pill" onclick="filterCat('${c.name}',this)">${c.name}</div>`;
            });
            
            loadProducts('all');
            if(currentUser) setupUserUI();
        }

        function loadProducts(c) {
            const g = document.getElementById('productGrid');
            g.innerHTML = '';
            products.forEach(p => {
                if ((c === 'all' || p.cat === c) && p.available) {
                    const minPrice = p.variants ? Math.min(...p.variants.map(v => v.price)) : 0;
                    g.innerHTML += `
                        <div class="product-card">
                            <img src="${p.img}">
                            <div class="product-info">
                                <h3>${p.name}</h3>
                                <div class="price-tag">${minPrice} Ø¬.Ù…</div>
                                <button class="add-btn" onclick="openOptions('${p.name}')">
                                    <i class="fas fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©
                                </button>
                            </div>
                        </div>`;
                }
            });
        }

        function filterCat(c, b) {
            document.querySelectorAll('.cat-pill').forEach(x => x.classList.remove('active'));
            b.classList.add('active');
            loadProducts(c);
        }

        function openOptions(n) {
            selectedProductTemp = products.find(p => p.name === n);
            currentQty = 1; // Ø±ÙŠØ³Øª Ù„Ù„ÙƒÙ…ÙŠØ© Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ù…Ù†ØªØ¬

            document.getElementById('optProdName').innerText = n;
            document.getElementById('optProdImg').src = selectedProductTemp.img;
            document.getElementById('qtyCount').innerText = currentQty;
            document.getElementById('itemNote').value = ""; // ØªØµÙÙŠØ± Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª

            const l = document.getElementById('variantsList');
            l.innerHTML = '';

            selectedProductTemp.variants.forEach((v, i) => {
                l.innerHTML += `
                    <div class="variant-card" onclick="selectVar(${i}, this)" id="var-${i}">
                        <b>${v.bread}</b>
                        <span class="price">${v.price} Ø¬.Ù…</span>
                    </div>`;
            });

            // Ø§Ø®ØªÙŠØ§Ø± Ø£ÙˆÙ„ Ù†ÙˆØ¹ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹
            selectVar(0, document.getElementById('var-0'));
            document.getElementById('optionsModal').style.display = 'flex';
        }

        function selectVar(i, el) {
            document.querySelectorAll('.variant-card').forEach(x => x.classList.remove('active'));
            el.classList.add('active');
            selectedVariantTemp = selectedProductTemp.variants[i];
            calculateFinalPrice();
        }

        function updateQty(val) {
            currentQty += val;
            if (currentQty < 1) currentQty = 1;
            document.getElementById('qtyCount').innerText = currentQty;
            calculateFinalPrice();
        }

        function calculateFinalPrice() {
            if (selectedVariantTemp) {
                const total = selectedVariantTemp.price * currentQty;
                document.getElementById('finalModalPrice').innerText = total + " Ø¬.Ù…";
            }
        }

        function confirmAddToCart() {
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ù„Ù„Ø³Ù„Ø© Ù…Ø¹ Ø§Ù„ÙƒÙ…ÙŠØ©
            cart.push({
                ...selectedProductTemp,
                variant: selectedVariantTemp,
                qty: currentQty,
                totalItemPrice: selectedVariantTemp.price * currentQty,
                note: document.getElementById('itemNote').value
            });

            updateCart();
            closeModal('optionsModal');

            // Ø£Ù†ÙŠÙ…ÙŠØ´Ù† ØµØºÙŠØ± Ù„Ù„ØªØ£ÙƒÙŠØ¯
            const cartBtn = document.querySelector('.icon-btn');
            cartBtn.style.transform = "scale(1.2)";
            setTimeout(() => cartBtn.style.transform = "scale(1)", 200);
        }

        function updateCart() {
            const count = cart.length;
            document.getElementById('cartCount').innerText = count;
            document.getElementById('bottomCartCount').innerText = count; // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ù‚Ù… ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ
            document.getElementById('itemsCount').innerText = count; // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø³Ù„Ø©

            const container = document.getElementById('cartItems');

            if (cart.length === 0) {
                container.innerHTML = `
                    <div style="text-align:center; padding: 40px 0; color: #94a3b8;">
                        <i class="fas fa-cart-plus" style="font-size: 3rem; margin-bottom: 10px; opacity: 0.3;"></i>
                        <p>Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ© Ø­Ø§Ù„ÙŠØ§Ù‹</p>
                    </div>`;
                return;
            }

            container.innerHTML = cart.map((item, index) => `
                <div class="cart-item-card">
                    <div style="display: flex; align-items: center;">
                        <i class="far fa-times-circle remove-item-btn" onclick="removeFromCart(${index})"></i>
                        <div class="cart-item-info">
                            <h4>${item.qty} Ã— ${item.name}</h4>
                            <span>${item.variant.bread} ${item.note ? ' - ' + item.note : ''}</span>
                        </div>
                    </div>
                    <div class="cart-item-price">
                        <b>${item.totalItemPrice} Ø¬</b>
                    </div>
                </div>
            `).join('');

            const total = cart.reduce((sum, item) => sum + item.totalItemPrice, 0);
            document.getElementById('cartTotal').innerText = total + " Ø¬.Ù…";
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCart();
        }

        function openCart() { document.getElementById('cartModal').style.display = 'flex'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
        function openAuth() { document.getElementById('authModal').style.display = 'flex'; }

        function openProfile() {
            if(!currentUser) return openAuth();

            const details = document.getElementById('profileDetails');
            details.innerHTML = `
                <div class="profile-info-row">
                    <i class="fas fa-user"></i>
                    <div style="text-align:right">
                        <small style="display:block; color:#94a3b8">Ø§Ù„Ø§Ø³Ù…</small>
                        <b>${currentUser.name}</b>
                    </div>
                </div>
                <div class="profile-info-row">
                    <i class="fas fa-phone"></i>
                    <div style="text-align:right">
                        <small style="display:block; color:#94a3b8">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</small>
                        <b>${currentUser.phone}</b>
                    </div>
                </div>
                <div class="profile-info-row">
                    <i class="fas fa-map-marker-alt"></i>
                    <div style="text-align:right">
                        <small style="display:block; color:#94a3b8">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</small>
                        <b>${currentUser.address}</b>
                    </div>
                </div>
            `;
            document.getElementById('profileModal').style.display = 'flex';
        }

        function logoutUser() {
            if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ')) {
                localStorage.removeItem('sheikh_user_info');
                location.reload();
            }
        }

        function handleRegister() {
            const name = document.getElementById('regName').value;
            const phone = document.getElementById('regPhone').value;
            const zone = document.getElementById('regZone').value;
            const addr = document.getElementById('regAddress').value;
            if(name && phone && zone && addr) {
                currentUser = { name, phone, address: `${zone} - ${addr}`, zone, coords: tempCoords };
                localStorage.setItem('sheikh_user_info', JSON.stringify(currentUser));
                setupUserUI();
                closeModal('authModal');
            } else {
                alert("Ø¨Ø±Ø¬Ø§Ø¡ Ø¥ÙƒÙ…Ø§Ù„ ÙƒØ§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
            }
        }

        function setupUserUI() {
            document.getElementById('loginBtnNav').style.display = 'none';
            document.getElementById('userProfileNav').style.display = 'flex';
        }

        function submitOrder() {
            if(!currentUser) return openAuth();
            if(cart.length === 0) return alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©!");
            
            const orderData = {
                customerName: currentUser.name,
                phone: currentUser.phone,
                address: currentUser.address,
                items: cart,
                total: document.getElementById('cartTotal').innerText,
                status: 'pending',
                timestamp: Date.now()
            };
            
            DB.push('orders', orderData);
            cart = [];
            updateCart();
            closeModal('cartModal');
            document.getElementById('successModal').style.display = 'flex';
        }

        function openMyOrders() {
            if(!currentUser) return openAuth();
            const orders = Object.values(DB.get('orders')).filter(o => o.phone === currentUser.phone);
            const list = document.getElementById('ordersList');
            list.innerHTML = orders.reverse().map(o => `
                <div class="cart-item" style="flex-direction:column; align-items:flex-start;">
                    <div style="display:flex; justify-content:space-between; width:100%; margin-bottom:5px;">
                        <b style="color:var(--primary)">${o.total}</b>
                        <span style="font-size:0.8rem; background:#eee; padding:2px 8px; border-radius:5px;">${o.status === 'pending' ? 'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±' : 'ØªÙ… Ø§Ù„ØªÙ†ÙÙŠØ°'}</span>
                    </div>
                    <small style="color:var(--text-muted)">${new Date(o.timestamp).toLocaleString('ar-EG')}</small>
                </div>
            `).join('') || "<p style='text-align:center'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø³Ø§Ø¨Ù‚Ø©</p>";
            document.getElementById('ordersModal').style.display = 'flex';
        }

        function closeSuccessModal() {
            closeModal('successModal');
            openMyOrders();
        }

        // GPS logic
        function getUserLocation() {
            const btn = document.getElementById('gpsBtn');
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹Ùƒ...';
            navigator.geolocation.getCurrentPosition(
                (pos) => {
                    tempCoords = { lat: pos.coords.latitude, lng: pos.coords.longitude };
                    document.getElementById('regAddress').value = "ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø¯Ù‚Ø© Ø¹Ø¨Ø± GPS âœ…";
                    btn.style.background = "#059669";
                    btn.innerHTML = '<i class="fas fa-check"></i> ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ø¨Ù†Ø¬Ø§Ø­';
                },
                () => {
                    alert("Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù„Ù… Ù†ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù…ÙˆÙ‚Ø¹Ùƒ. Ø¨Ø±Ø¬Ø§Ø¡ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù€ GPS");
                    btn.innerHTML = '<i class="fas fa-location-arrow"></i> Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰';
                }
            );
        }

        function toggleChat() {
            const w = document.getElementById('chatWindow');
            w.style.display = w.style.display === 'none' ? 'flex' : 'none';
        }

        function sendChat() {
            const input = document.getElementById('chatInput');
            if(input.value.trim()) {
                const body = document.getElementById('chatBody');
                body.innerHTML += `
                    <div style="background:var(--primary); color:white; padding:10px 15px; border-radius:15px 15px 0 15px; align-self:flex-end; max-width:80%;">
                        ${input.value}
                    </div>
                `;
                input.value = '';
                body.scrollTop = body.scrollHeight;
            }
        }

        // Init on load
        window.onload = () => {
            initData();
            refreshUI();
            setTimeout(() => {
                document.getElementById('loader-wrapper').style.opacity = '0';
                setTimeout(() => document.getElementById('loader-wrapper').style.display = 'none', 500);
            }, 1200);
        };

        window.addEventListener('db_updated', refreshUI);

        // Export functions to window
        window.submitOrder = submitOrder;
        window.openOrder = openOrder;
        window.upStatus = upStatus;
          // Ø¬Ø³Ø± Ø§Ù„Ø±Ø¨Ø· Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠ
window.filterCat = filterCat;
window.openOptions = openOptions;
window.updateQty = updateQty;
window.confirmAddToCart = confirmAddToCart;
window.openCart = openCart;
window.submitOrder = submitOrder;
window.handleRegister = handleRegister;
window.openMyOrders = openMyOrders;
window.closeModal = closeModal;
window.openAuth = openAuth;
window.toggleChat = toggleChat;
window.sendChat = sendChat;
window.getUserLocation = getUserLocation;

console.log("ØªÙ… Ø±Ø¨Ø· ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø´ØªØ±ÙŠ Ø¨Ø§Ù„Ø³Ø­Ø§Ø¨ âœ…");
    </script>
</body>
</html>
